% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Go_Ancom2_v2.R
\name{Go_Ancom2}
\alias{Go_Ancom2}
\title{Perform ANCOM-II Analysis on Phyloseq Data}
\usage{
Go_Ancom2(
  psIN,
  project,
  data_type = "other",
  taxanames = NULL,
  cate.outs,
  cate.conf = NULL,
  cont.conf = NULL,
  rand.eff = NULL,
  orders = NULL,
  name = NULL
)
}
\arguments{
\item{psIN}{A \code{phyloseq} object containing count data and sample metadata.}

\item{project}{Character. Project or analysis name (used in output paths).}

\item{data_type}{Character. One of \code{c("taxonomy","kegg","pathway","RNAseq")}.}

\item{taxanames}{Character or NULL. Taxonomic rank to report (e.g., \code{"Genus"}).}

\item{cate.outs}{Character vector. Categorical outcomes to analyze.}

\item{cate.conf}{Character vector or NULL. Categorical confounders to adjust for.}

\item{cont.conf}{Character vector or NULL. Continuous confounders to adjust for.}

\item{rand.eff}{Character or NULL. Random-effect column name in \code{sample_data(psIN)}
(e.g., subject ID) to be modeled as a random intercept. Use \code{NULL} for no random effect.}

\item{orders}{Character vector or NULL. Custom factor level order for outcomes/confounders.}

\item{name}{Character or NULL. Extra tag appended to output filenames.}
}
\value{
Invisibly returns a list of data.frames (one per analysis), and writes CSV
files containing ANCOM-II results (W-statistic, p-values, q-values/fdr, effect sizes)
merged with taxonomy where applicable.
}
\description{
This function runs ANCOM-II on a phyloseq object. It supports categorical and
continuous variables and allows adjusting for confounders. For categorical
outcomes, it can iterate over level combinations and save per-contrast results.
}
\details{
The function prepares the design from \code{sample_data(psIN)}, optionally sets a random
intercept via \code{rand.eff}, runs ANCOM-II per outcome (and per level comparison when
applicable), and saves tidy results under \code{<project>_<YYMMDD>/table/}.
}
\examples{
\donttest{
Go_Ancom2(
  psIN      = psIN,
  project   = "MyProject",
  data_type = "taxonomy",
  cate.outs = c("Treatment","Condition"),
  cate.conf = "Gender",
  cont.conf = NULL,
  orders    = NULL,
  name      = "Analysis1"
)
}

}
