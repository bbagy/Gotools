#install.packages("devtools")
library(devtools)
devtools::install_github("bbagy/Gotools") # or install.packages("Gomarkdown_0.0.0.9000.tar.gz", repos = NULL, type="source")
#install.packages("devtools")
library(devtools)
devtools::install_github("bbagy/Gotools") # or install.packages("Gomarkdown_0.0.0.9000.tar.gz", repos = NULL, type="source")
#install.packages("devtools")
library(devtools)
devtools::install_github("bbagy/Gotools") # or install.packages("Gomarkdown_0.0.0.9000.tar.gz", repos = NULL, type="source")
for (package in bioconductor_packages) {
install_load_bioc(package)
}
bioconductor_packages <- c("phyloseq", "microbiome", "Rhtslib", "dada2", "dplyr",
"ggpubr", "ggfortify", "genefilter", "ggpmisc", "S4Vectors",
"ShortRead", "illuminaio", "rstatix", "useful", "DECIPHER",
"ComplexHeatmap", "DESeq2", "ALDEx2","scater")
for (package in bioconductor_packages) {
install_load_bioc(package)
}
install_load_bioc <- function(package) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
if (!require("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install(package, force = TRUE, ask = FALSE, type = "source")
}
library(package, character.only = TRUE, quietly = TRUE)
}
# Installing and loading CRAN packages
for (package in cran_packages) {
install_load_cran(package)
}
bioconductor_packages <- c("phyloseq", "microbiome", "Rhtslib", "dada2", "dplyr",
"ggpubr", "ggfortify", "genefilter", "ggpmisc", "S4Vectors",
"ShortRead", "illuminaio", "rstatix", "useful", "DECIPHER",
"ComplexHeatmap", "DESeq2", "ALDEx2","scater")
for (package in bioconductor_packages) {
install_load_bioc(package)
}
library(dada2)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("dada2", version = "3.11")
BiocManager::install("dada2")
BiocManager::install("dada2")
BiocManager::install("Rsamtools", verbose = TRUE)
BiocManager::install("Rsamtools", verbose = TRUE)
BiocManager::install("Rsamtools", verbose = TRUE)
BiocManager::install("Rsamtools", verbose = TRUE)
BiocManager::install("Rsamtools", verbose = TRUE)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("dada2")
BiocManager::install("Rsamtools", verbose = TRUE)
library(Rsamtools)
# Function to install and load Bioconductor packages
install_load_bioc <- function(package) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
if (!require("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install(package, force = TRUE, ask = FALSE, type = "source")
}
library(package, character.only = TRUE, quietly = TRUE)
}
# Installing and loading CRAN packages
bioconductor_packages <- c("phyloseq", "microbiome", "Rhtslib", "dada2", "dplyr",
"ggpubr", "ggfortify", "genefilter", "ggpmisc", "S4Vectors",
"ShortRead", "illuminaio", "rstatix", "useful", "DECIPHER",
"ComplexHeatmap", "DESeq2", "ALDEx2","scater")
for (package in bioconductor_packages) {
install_load_bioc(package)
}
# Function to install and load Bioconductor packages
install_load_bioc <- function(package) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
if (!require("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install(package, force = TRUE, ask = FALSE, type = "source")
}
library(package, character.only = TRUE, quietly = TRUE)
}
# Installing and loading CRAN packages
bioconductor_packages <- c("phyloseq", "microbiome", "Rhtslib", "dada2", "dplyr",
"ggpubr", "ggfortify", "genefilter", "ggpmisc", "S4Vectors",
"ShortRead", "illuminaio", "rstatix", "useful", "DECIPHER",
"ComplexHeatmap", "DESeq2", "ALDEx2")#,"scater"
for (package in bioconductor_packages) {
install_load_bioc(package)
}
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("dada2")
library(dada2)
library(dada2)
BiocManager::install("Rsamtools", verbose = TRUE)
# Function to install and load Bioconductor packages
install_load_bioc <- function(package) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
if (!require("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install(package, force = TRUE, ask = FALSE, type = "source")
}
library(package, character.only = TRUE, quietly = TRUE)
}
# Installing and loading CRAN packages
bioconductor_packages <- c("phyloseq", "microbiome", "Rhtslib", "dada2", "dplyr",
"ggpubr", "ggfortify", "genefilter", "ggpmisc", "S4Vectors",
"ShortRead", "illuminaio", "rstatix", "useful", "DECIPHER",
"ComplexHeatmap", "DESeq2", "ALDEx2")#,"scater"
for (package in bioconductor_packages) {
install_load_bioc(package)
}
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("dada2")
library(dada2)
BiocManager::install("scater", verbose = TRUE)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("scater", verbose = TRUE)
BiocManager::install("scater", verbose = TRUE,force = TRUE`)
BiocManager::install("scater", verbose = TRUE,force = TRUE)
# Installing and loading CRAN packages
bioconductor_packages <- c("phyloseq", "microbiome", "Rhtslib", "dada2", "dplyr",
"ggpubr", "ggfortify", "genefilter", "ggpmisc", "S4Vectors",
"ShortRead", "illuminaio", "rstatix", "useful", "DECIPHER",
"ComplexHeatmap", "DESeq2", "ALDEx2","scater")
for (package in bioconductor_packages) {
install_load_bioc(package)
}
# Function to install and load Bioconductor packages
install_load_bioc <- function(package) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
if (!require("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install(package, force = TRUE, ask = FALSE, type = "source")
}
library(package, character.only = TRUE, quietly = TRUE)
}
# Installing and loading CRAN packages
bioconductor_packages <- c("phyloseq", "microbiome", "Rhtslib", "dada2", "dplyr",
"ggpubr", "ggfortify", "genefilter", "ggpmisc", "S4Vectors",
"ShortRead", "illuminaio", "rstatix", "useful", "DECIPHER",
"ComplexHeatmap", "DESeq2", "ALDEx2","scater")
for (package in bioconductor_packages) {
install_load_bioc(package)
}
Gotool_dependency <- function() {
# Packages to install from CRAN
cran_packages <- c("ape", "Boruta", "car", "cluster", "CLME", "compositions",
"cowplot", "crayon", "caret", "colorspace", "digest",
"data.table", "devtools", "doParallel", "ellipse", "emmeans",
"e1071", "gplots", "ggplot2", "grid", "gridExtra", "ggrepel",
"doRNG", "ggalluvial", "ggforce", "Hmisc", "irlba", "huge",  "igraph",
"irr", "lme4", "lmerTest", "nnet", "MLmetrics",
"Matrix", "magrittr", "MASS", "missForest", "magick", "nlme",
"phangorn", "pheatmap", "pkgconfig", "dplyr", "parallel", "pscl",
"plotly", "pdftools", "rfUtilities", "rlang", "randomForest",
"readxl", "RColorBrewer", "ROCR", "reshape", "reshape2", "yarrr",
"stringi", "tidyverse", "vegan", "VGAM", "picante", "zoo",
"RcppZiggurat", "Rfast", "survival", "withr", "knitr", "kableExtra", "DT")
# Packages to install from Bioconductor
bioconductor_packages <- c("phyloseq", "microbiome", "Rhtslib", "dada2", "dplyr",
"ggpubr", "ggfortify", "genefilter", "ggpmisc", "S4Vectors",
"ShortRead", "illuminaio", "rstatix", "useful", "DECIPHER",
"ComplexHeatmap", "DESeq2", "ALDEx2","scater")
# Function to install and load CRAN packages
install_load_cran <- function(package) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
install.packages(package)
}
library(package, character.only = TRUE, quietly = TRUE)
}
# Function to install and load Bioconductor packages
install_load_bioc <- function(package) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
if (!require("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install(package, force = TRUE, ask = FALSE, type = "source")
}
library(package, character.only = TRUE, quietly = TRUE)
}
# Installing and loading CRAN packages
for (package in cran_packages) {
install_load_cran(package)
}
# Installing and loading Bioconductor packages
for (package in bioconductor_packages) {
install_load_bioc(package)
}
# Print success message
if (require("crayon", quietly = TRUE)) {
cat(crayon::blue("#--------------------------------------------------------------# \n"))
cat(crayon::blue("#------       General analysis Of microbiome (Go)        ------# \n"))
cat(crayon::blue("#------    Quick statistics and visualization tools      ------# \n"))
cat(crayon::blue("#------                (with R markdown)                 ------# \n"))
cat(crayon::blue("#--------------------------------------------------------------# \n"))
cat(crayon::yellow("All the required packages were installed and loaded.\n"))
cat(crayon::blue("#--------------------------------------------------------------# \n"))
} else {
cat("#--------------------------------------------------------------# \n")
cat("All the required packages were installed and loaded.\n")
cat("#--------------------------------------------------------------# \n")
}
}
Gotool_dependency()
Gotool_dependency <- function() {
# Packages to install from CRAN
cran_packages <- c("ape", "Boruta", "car", "cluster", "CLME", "compositions",
"cowplot", "crayon", "caret", "colorspace", "digest",
"data.table", "devtools", "doParallel", "ellipse", "emmeans",
"e1071", "gplots", "ggplot2", "grid", "gridExtra", "ggrepel",
"doRNG", "ggalluvial", "ggforce", "Hmisc", "irlba", "huge",  "igraph",
"irr", "lme4", "lmerTest", "nnet", "MLmetrics",
"Matrix", "magrittr", "MASS", "missForest", "magick", "nlme",
"phangorn", "pheatmap", "pkgconfig", "dplyr", "parallel", "pscl",
"plotly", "pdftools", "rfUtilities", "rlang", "randomForest",
"readxl", "RColorBrewer", "ROCR", "reshape", "reshape2", "yarrr",
"stringi", "tidyverse", "vegan", "VGAM", "picante", "zoo",
"RcppZiggurat", "Rfast", "survival", "withr", "knitr", "kableExtra", "DT","shiny")
# Packages to install from Bioconductor
bioconductor_packages <- c("phyloseq", "microbiome", "Rhtslib", "dada2", "dplyr",
"ggpubr", "ggfortify", "genefilter", "ggpmisc", "S4Vectors",
"ShortRead", "illuminaio", "rstatix", "useful", "DECIPHER",
"ComplexHeatmap", "DESeq2", "ALDEx2","scater")
# Function to install and load CRAN packages
install_load_cran <- function(package) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
install.packages(package)
}
library(package, character.only = TRUE, quietly = TRUE)
}
# Function to install and load Bioconductor packages
install_load_bioc <- function(package) {
if (!require(package, character.only = TRUE, quietly = TRUE)) {
if (!require("BiocManager", quietly = TRUE)) {
install.packages("BiocManager")
}
BiocManager::install(package, force = TRUE, ask = FALSE, type = "source")
}
library(package, character.only = TRUE, quietly = TRUE)
}
# Installing and loading CRAN packages
for (package in cran_packages) {
install_load_cran(package)
}
# Installing and loading Bioconductor packages
for (package in bioconductor_packages) {
install_load_bioc(package)
}
# Print success message
if (require("crayon", quietly = TRUE)) {
cat(crayon::blue("#--------------------------------------------------------------# \n"))
cat(crayon::blue("#------       General analysis Of microbiome (Go)        ------# \n"))
cat(crayon::blue("#------    Quick statistics and visualization tools      ------# \n"))
cat(crayon::blue("#------                (with R markdown)                 ------# \n"))
cat(crayon::blue("#--------------------------------------------------------------# \n"))
cat(crayon::yellow("All the required packages were installed and loaded.\n"))
cat(crayon::blue("#--------------------------------------------------------------# \n"))
} else {
cat("#--------------------------------------------------------------# \n")
cat("All the required packages were installed and loaded.\n")
cat("#--------------------------------------------------------------# \n")
}
}
# ----- Libraries and functions ------#
# source("~/Dropbox/04_Scripts/R_source/microbiome3/Go_tools/Go_tools.5.0.1.R")
# devtools::install_github("bbagy/Gotools")
library("Gotools")
Gotool_dependency()
tools::package_dependencies("shiny", which = c("Depends", "Imports"), recursive = TRUE)
devtools::install_github("bbagy/Gotools")
#install.packages("devtools")
library(devtools)
devtools::install_github("bbagy/Gotools") # or install.packages("Gomarkdown_0.0.0.9000.tar.gz", repos = NULL, type="source")
#install.packages("devtools")
library(devtools)
devtools::install_github("bbagy/Gotools") # or install.packages("Gomarkdown_0.0.0.9000.tar.gz", repos = NULL, type="source")
library("Gotools")
#install.packages("devtools")
library(devtools)
devtools::install_github("bbagy/Gotools") # or install.packages("Gomarkdown_0.0.0.9000.tar.gz", repos = NULL, type="source")
library("Gotools")
Gotool_dependency()
devtools::install_github("bbagy/Gotools",force = TRUE)
install.packages("devtools")
#install.packages("devtools")
library(devtools)
devtools::install_github("bbagy/Gotools") # or install.packages("Gomarkdown_0.0.0.9000.tar.gz", repos = NULL, type="source")
#install.packages("devtools")
library(devtools)
install.packages(c("usethis", "pkgdown"))
install.packages("devtools")
install.packages(c("openssl", "systemfonts", "credentials", "httr", "httr2", "gert", "gh", "usethis", "pkgdown"))
install.packages("devtools")
install.packages("devtools")
# install.packages("devtools")
library(devtools)
devtools::install_github("bbagy/Gotools") # or install.packages("Gomarkdown_0.0.0.9000.tar.gz", repos = NULL, type="source")
library("Gotools")
library("Gotools")
Gotool_dependency()
#===== Read Go_tools
# devtools::install_github("bbagy/Gotools")
library("Gotools")
rm(list=ls())
# ----- Libraries and functions ------#
# devtools::install_github("bbagy/Gotools", force=T)
library("Gotools")
#=============================#
#----    Set analysis    -----#
#=============================#
source("/Users/heekukpark/Dropbox/04_scripts/R_source/R_storage/1_R_History/2024/FB_Inuline/20240410_FB_Rmd_starter.R")
#===== Read Go_tools
# devtools::install_github("bbagy/Gotools", force=T)
library("Gotools")
Gotool_dependency()
project_name <- "Prebiotic (Inuline) 16S microbiome – Dr. Daniel Freedberg"
samples <- "344 (94 Participants)"
Sequencing.date <- "12/28/2023"
platform <- "Illumina MiSeq 2x300"
contact_email <- "hp2523@cumc.columbia.edu"
expInfo <- Go_expInfo(kit_number = 6,prep_number = 1, spikein_number = 2)
devtools::install_github("bbagy/Gotools", force=T)
#===== Read Go_tools
# devtools::install_github("bbagy/Gotools", force=T)
library("Gotools")
Gotool_dependency()
project_name <- "Prebiotic (Inuline) 16S microbiome – Dr. Daniel Freedberg"
samples <- "344 (94 Participants)"
Sequencing.date <- "12/28/2023"
platform <- "Illumina MiSeq 2x300"
contact_email <- "hp2523@cumc.columbia.edu"
expInfo <- Go_expInfo(kit_number = 6,prep_number = 1, spikein_number = 2)
devtools::install_github("bbagy/Gotools", force=T)
#===== Read Go_tools
# devtools::install_github("bbagy/Gotools", force=T)
library("Gotools")
Gotool_dependency()
project_name <- "Prebiotic (Inuline) 16S microbiome – Dr. Daniel Freedberg"
samples <- "344 (94 Participants)"
Sequencing.date <- "12/28/2023"
platform <- "Illumina MiSeq 2x300"
contact_email <- "hp2523@cumc.columbia.edu"
expInfo <- Go_expInfo(kit_number = 6,prep_number = 1, spikein_number = 2)
expInfo <- Go_expInfo(kit_number = 6, prep_number = 1, spikein_number = 2, authorName1="Heekuk Park",authorName2="Dwayne Seeram");expInfo
#===== Read Go_tools
# devtools::install_github("bbagy/Gotools", force=T)
library("Gotools")
Gotool_dependency()
#=====  Define project
project_name <- "Prebiotic (Inuline) 16S microbiome – Dr. Daniel Freedberg"
samples <- "344 (94 Participants)"
Sequencing.date <- "12/28/2023"
platform <- "Illumina MiSeq 2x300"
contact_email<-"hp2523@cumc.columbia.edu"
expInfo <- Go_expInfo(kit_number = 6, prep_number = 1, spikein_number = 2, authorName1="Heekuk Park",authorName2="Dwayne Seeram");expInfo
expInfo$contact_email
# Read the external HTML file content
html_content <- readLines("/Users/heekukpark/Dropbox/04_scripts/R_source/Gotool_html/email_form.html", warn = FALSE)
# Replace placeholders with actual R variables
contact_email <- expInfo$contact_email
html_content <- gsub("\\{\\{project_name\\}\\}", project_name, html_content)
html_content <- gsub("\\{\\{contact_email\\}\\}", contact_email, html_content)
# Print the modified HTML content into the R Markdown document
cat(html_content, sep = "\n")
contact_email<- expInfo$contact_email
# Read the external HTML file content
html_content <- readLines("/Users/heekukpark/Dropbox/04_scripts/R_source/Gotool_html/email_form.html", warn = FALSE)
# Replace placeholders with actual R variables
contact_email <- expInfo$contact_email
html_content <- gsub("\\{\\{project_name\\}\\}", project_name, html_content)
html_content <- gsub("\\{\\{contact_email\\}\\}", contact_email, html_content)
# Print the modified HTML content into the R Markdown document
cat(html_content, sep = "\n")
contact_email<- expInfo$contact_email
contact_email
contact_email<-c("hp2523@cumc.columbia.edu", "ds4057@cumc.columbia.edu")
# Read the external HTML file content
html_content <- readLines("/Users/heekukpark/Dropbox/04_scripts/R_source/Gotool_html/email_form.html", warn = FALSE)
# Replace placeholders with actual R variables
contact_email <- contact_email
html_content <- gsub("\\{\\{project_name\\}\\}", project_name, html_content)
html_content <- gsub("\\{\\{contact_email\\}\\}", contact_email, html_content)
# Print the modified HTML content into the R Markdown document
cat(html_content, sep = "\n")
contact_email<-c("ds4057@cumc.columbia.edu")
# Read the external HTML file content
html_content <- readLines("/Users/heekukpark/Dropbox/04_scripts/R_source/Gotool_html/email_form.html", warn = FALSE)
# Replace placeholders with actual R variables
contact_email <- contact_email
html_content <- gsub("\\{\\{project_name\\}\\}", project_name, html_content)
html_content <- gsub("\\{\\{contact_email\\}\\}", contact_email, html_content)
# Print the modified HTML content into the R Markdown document
cat(html_content, sep = "\n")
# Join the email addresses with a comma if there are two
contact_email_joined <- paste(contact_email, collapse = ",")
contact_email_joined
expInfo <- Go_expInfo(kit_number = 6, prep_number = 1, spikein_number = 2, authorName1="Heekuk Park",authorName2="Dwayne Seeram");expInfo
contact_email<- expInfo$contact_email
# Join the email addresses with a comma if there are two
contact_email_joined <- paste(contact_email, collapse = ",")
contact_email_joined
# Your existing code to replace placeholders
html_content <- readLines("/Users/heekukpark/Dropbox/04_scripts/R_source/Gotool_html/email_form.html", warn = FALSE)
html_content <- gsub("\\{\\{project_name\\}\\}", project_name, html_content)
html_content <- gsub("\\{\\{contact_email\\}\\}", contact_email_joined, html_content)
# Print the modified HTML content
cat(html_content, sep = "\n")
expInfo <- Go_expInfo(kit_number = 6, prep_number = 1, spikein_number = 2, authorName1="Heekuk Park",authorName2=NULL);expInfo
contact_email<- expInfo$contact_email
# Join the email addresses with a comma if there are two
contact_email_joined <- paste(contact_email, collapse = ",")
# Your existing code to replace placeholders
html_content <- readLines("/Users/heekukpark/Dropbox/04_scripts/R_source/Gotool_html/email_form.html", warn = FALSE)
html_content <- gsub("\\{\\{project_name\\}\\}", project_name, html_content)
html_content <- gsub("\\{\\{contact_email\\}\\}", contact_email_joined, html_content)
# Print the modified HTML content
cat(html_content, sep = "\n")
library(rmarkdown)
# Path to your R Markdown template
rmd_template_path <- "/Users/heekukpark/Dropbox/04_scripts/R_source/R_storage/1_R_History/2024/FB_Inuline/20240410_Summary_report_tem_v1.Rmd"
# Render the Rmd file to an HTML output
render(input = rmd_template_path, output_format = "html_document")
library(rmarkdown)
# Path to your R Markdown template
rmd_template_path <- "/Users/heekukpark/Dropbox/04_scripts/R_source/R_storage/1_R_History/2024/FB_Inuline/20240410_Summary_report_tem_v1.Rmd"
# Render the Rmd file to an HTML output
render(input = rmd_template_path, output_format = "html_document")
# Path to your R Markdown template
rmd_template_path <- "/Users/heekukpark/Dropbox/04_scripts/R_source/R_storage/1_R_History/2024/FB_Inuline/20240410_Summary_report_tem_v1.Rmd"
# Render the Rmd file to an HTML output
render(input = rmd_template_path, output_format = "html_document")
#######################################################
#---------     Core general Rmd starter      ---------#
#######################################################
# rm(list=ls())
# list.files()
#===== Read Go_tools
# devtools::install_github("bbagy/Gotools", force=T)
library("Gotools")
Gotool_dependency()
devtools::install_github("bbagy/Gotools", force=T)
#===== Read Go_tools
# devtools::install_github("bbagy/Gotools", force=T)
library("Gotools")
Gotool_dependency()
#=====  Define project
project_name <- "Prebiotic (Inuline) 16S microbiome – Dr. Daniel Freedberg"
samples <- "344 (94 Participants)"
Sequencing.date <- "12/28/2023"
platform <- "Illumina MiSeq 2x300"
expInfo <- Go_expInfo(kit_number = 6, prep_number = 1, spikein_number = 2, authorName1="Heekuk Park",authorName2=NULL);expInfo
#==========================================#
#=====  PICRUSt    =====#
#==========================================#
# Go_function2ps(tabPath = "5_picrust2_final_out_FB_20240205/path_abun_unstrat_descrip_FB_20240205.tsv.gz", project=project, func.type="picrust", name=NULL)
path <- readRDS("2_rds/ps.PICRUSTt2.pathway..FB_merged.240425.rds")
#=====  Define project
project_name <- "Prebiotic (Inuline) 16S microbiome – Dr. Daniel Freedberg"
samples <- "344 (94 Participants)"
Sequencing.date <- "12/28/2023"
platform <- "Illumina MiSeq 2x300"
expInfo <- Go_expInfo(kit_number = 6, prep_number = 1, spikein_number = 2, authorName1="Heekuk Park",authorName2=NULL);expInfo
#===== Set work directory
project<-"FB_merged"
currentwd <- "~/cumc.columbia.edu/Uhlemann Lab - Microbiome Core/1_Projects/MAPS_FB_Inu/2_Analysis/FB_merged_240205/"
setwd(sprintf("%s",currentwd))
da.wd <- sprintf("%s/FB_merged_240411/pdf/DA_plot/",currentwd)
image.wd <- sprintf("%s/FB_merged_240411/pdf",currentwd)
#===== Input
asvs <- read.csv("1_out/FB_merged.240212.psTotab.asvTable.csv",row.names=1,check.names=FALSE);dim(asvs)
sampledata <- read.csv("3_map/240423.FB_overall.mapping.csv",row.names=1,check.names=F);head(sampledata)
#==========================================#
#=====  PICRUSt    =====#
#==========================================#
# Go_function2ps(tabPath = "5_picrust2_final_out_FB_20240205/path_abun_unstrat_descrip_FB_20240205.tsv.gz", project=project, func.type="picrust", name=NULL)
path <- readRDS("2_rds/ps.PICRUSTt2.pathway..FB_merged.240425.rds")
sampledata <- read.csv("3_map/240423.FB_overall.mapping.csv",row.names=1,check.names=F);head(sampledata)
ps1 <- merge_phyloseq(path, sample_data(data.frame(sampledata)));ps1
ps1.sel <- subset_samples(ps1, TreatmentGroup != "A");ps1.sel
ps1.sel.sel <- subset_samples(ps1.sel, TreatmentGroup == "32g INULIN")
kw <- Go_groupBox(psIN=ps1.sel.sel, project, mainGroup= "Timepoint", rank = "pathway", name= "32g", orders=orders, mycols = mycols,  top=NULL, ylim=NULL, pval= 0.05, flip = T, standardsize=T)
kw.sel <- subset(kw, p.value < 0.05);dim(kw.sel)
#===== KW
ps1.sel.sel <- subset_samples(ps1.sel, TreatmentGroup == "PLACEBO")
kw <- Go_groupBox(psIN=ps1.sel.sel, project, mainGroup= "Timepoint", rank = "path.des", name= "PLACEBO", orders=orders, mycols = mycols,  top=NULL, ylim=NULL, pval= 0.05, flip = T, standardsize=T)
ps1.sel.sel <- subset_samples(ps1.sel, TreatmentGroup == "16g INULIN")
kw <- Go_groupBox(psIN=ps1.sel.sel, project, mainGroup= "Timepoint", rank = "path.des", name= "16g", orders=orders, mycols = mycols,  top=NULL, ylim=NULL, pval= 0.05, flip = T, standardsize=T)
ps1.sel.sel <- subset_samples(ps1.sel, TreatmentGroup == "32g INULIN")
kw <- Go_groupBox(psIN=ps1.sel.sel, project, mainGroup= "Timepoint", rank = "path.des", name= "32g", orders=orders, mycols = mycols,  top=NULL, ylim=NULL, pval= 0.05, flip = T, standardsize=T)
kw.sel <- subset(kw, p.value < 0.05);dim(kw.sel)
#===== filter pathway by kw
pathway_ids <- kw.sel$id  # Extracting the pathway IDs from your KW results
pathway_ids <- gsub("\\.", "-", pathway_ids) # match the words
indices <- which(tax_table(ps1.sel.sel)[, "pathway"] %in% pathway_ids)
taxa_to_keep <- rep(FALSE, ntaxa(ps1.sel)) # Creating a logical vector to keep taxa
taxa_to_keep[indices] <- TRUE
ps_filtered <- prune_taxa(taxa_to_keep, ps1.sel)
Go_extendedBarplot(psIN=ps_filtered,project,
mvar="Timepoint", group1="D0", group2="D3",func = "pathway", #  "KO", "KO.des", "pathway", "path.des"
wilcox.p = 0.5, name=NULL, height=3, width=10)
# build package
setwd("~/Dropbox/04_Scripts/R_source/Gotools")
devtools::build()
devtools::document()
cd ~/Dropbox/04_Scripts/R_source/Gotools
